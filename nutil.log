2025-05-20 12:52:15,959 - nutil.core.nutil - INFO - Initializing Nutil class.
2025-05-20 12:52:15,959 - nutil.core.nutil - DEBUG - Parameters: segmentation_folder=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/nonlinear_allen_mouse/segmentations/, alignment_json=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/nonlinear_allen_mouse/alignment.json, colour=[0, 0, 0], atlas_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas/annotation_25_reoriented_2017.nrrd, label_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas//allen2017_colours.csv, hemi_path=None, custom_region_path=None
2025-05-20 12:52:15,959 - nutil.core.nutil - DEBUG - Validating atlas parameters.
2025-05-20 12:52:15,959 - nutil.core.nutil - DEBUG - Atlas parameters validated successfully.
2025-05-20 12:52:15,959 - nutil.core.nutil - INFO - Loading custom atlas.
2025-05-20 12:52:16,706 - nutil.core.nutil - INFO - Custom atlas loaded successfully.
2025-05-20 12:52:16,706 - nutil.core.nutil - INFO - Starting coordinate extraction.
2025-05-20 12:52:16,706 - nutil.core.nutil - DEBUG - Parameters: non_linear=True, object_cutoff=0, use_flat=False, apply_damage_mask=True
2025-05-20 12:52:16,706 - nutil.core.nutil - INFO - Calling folder_to_atlas_space for coordinate extraction.
2025-05-20 12:52:22,505 - nutil.core.nutil - INFO - Coordinate extraction completed successfully.
2025-05-20 12:52:22,506 - nutil.core.nutil - DEBUG - Number of pixel points: 3000
2025-05-20 12:52:22,506 - nutil.core.nutil - DEBUG - Number of centroids: 30
2025-05-20 12:52:22,506 - nutil.core.nutil - INFO - Starting coordinate quantification.
2025-05-20 12:52:22,506 - nutil.core.nutil - INFO - Calling quantify_labeled_points for quantification.
2025-05-20 12:52:22,709 - nutil.core.nutil - INFO - Coordinate quantification completed successfully.
2025-05-20 12:52:22,710 - nutil.core.nutil - DEBUG - Label_df shape: (1328, 16)
2025-05-20 12:52:22,710 - nutil.core.nutil - INFO - Attempting to get region summary.
2025-05-20 12:52:22,710 - nutil.core.nutil - INFO - Region summary retrieved successfully.
2025-05-20 12:52:22,721 - nutil.core.nutil - INFO - Attempting to save analysis to: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-05-20 12:52:22,722 - nutil.core.nutil - INFO - Ensured output folder exists or created: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-05-20 12:52:23,155 - nutil.core.nutil - INFO - Analysis results saved successfully to: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-05-20 12:52:31,399 - nutil.core.nutil - INFO - Initializing Nutil class.
2025-05-20 12:52:31,399 - nutil.core.nutil - DEBUG - Parameters: segmentation_folder=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/nonlinear_allen_mouse/segmentations/, alignment_json=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/nonlinear_allen_mouse/alignment.json, colour=[0, 0, 0], atlas_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas/annotation_25_reoriented_2017.nrrd, label_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas//allen2017_colours.csv, hemi_path=None, custom_region_path=None
2025-05-20 12:52:31,399 - nutil.core.nutil - DEBUG - Validating atlas parameters.
2025-05-20 12:52:31,399 - nutil.core.nutil - DEBUG - Atlas parameters validated successfully.
2025-05-20 12:52:31,399 - nutil.core.nutil - INFO - Loading custom atlas.
2025-05-20 12:52:31,992 - nutil.core.nutil - INFO - Custom atlas loaded successfully.
2025-05-20 12:52:31,992 - nutil.core.nutil - INFO - Starting coordinate extraction.
2025-05-20 12:52:31,992 - nutil.core.nutil - DEBUG - Parameters: non_linear=True, object_cutoff=0, use_flat=False, apply_damage_mask=True
2025-05-20 12:52:31,992 - nutil.core.nutil - INFO - Calling folder_to_atlas_space for coordinate extraction.
2025-05-20 12:52:33,240 - nutil.core.nutil - INFO - Coordinate extraction completed successfully.
2025-05-20 12:52:33,240 - nutil.core.nutil - DEBUG - Number of pixel points: 3000
2025-05-20 12:52:33,240 - nutil.core.nutil - DEBUG - Number of centroids: 30
2025-05-20 12:52:33,240 - nutil.core.nutil - INFO - Starting coordinate quantification.
2025-05-20 12:52:33,242 - nutil.core.nutil - INFO - Calling quantify_labeled_points for quantification.
2025-05-20 12:52:33,482 - nutil.core.nutil - INFO - Coordinate quantification completed successfully.
2025-05-20 12:52:33,482 - nutil.core.nutil - DEBUG - Label_df shape: (1328, 16)
2025-05-20 12:52:33,482 - nutil.core.nutil - INFO - Attempting to get region summary.
2025-05-20 12:52:33,482 - nutil.core.nutil - INFO - Region summary retrieved successfully.
2025-05-20 12:52:33,504 - nutil.core.nutil - INFO - Attempting to save analysis to: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-05-20 12:52:33,504 - nutil.core.nutil - INFO - Ensured output folder exists or created: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-05-20 12:52:33,914 - nutil.core.nutil - INFO - Analysis results saved successfully to: ./test_result/2custom_atlas_hemi_test_24_03_2025
2025-06-02 09:47:56,297 - nutil.core.nutil - INFO - Initializing Nutil class.
2025-06-02 09:47:56,297 - nutil.core.nutil - DEBUG - Parameters: segmentation_folder=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/init_segments, alignment_json=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/aba_mouse_ccfv3_2017_25um_2025-04-11_07-50-43.json, colour=[0, 0, 255], atlas_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas/annotation_25_reoriented_2017.nrrd, label_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas//allen2017_colours.csv, hemi_path=None, custom_region_path=None
2025-06-02 09:47:56,299 - nutil.core.nutil - DEBUG - Validating atlas parameters.
2025-06-02 09:47:56,299 - nutil.core.nutil - DEBUG - Atlas parameters validated successfully.
2025-06-02 09:47:56,299 - nutil.core.nutil - INFO - Loading custom atlas.
2025-06-02 09:47:57,043 - nutil.core.nutil - INFO - Custom atlas loaded successfully.
2025-06-02 09:47:57,043 - nutil.core.nutil - INFO - Starting coordinate extraction.
2025-06-02 09:47:57,044 - nutil.core.nutil - DEBUG - Parameters: non_linear=True, object_cutoff=0, use_flat=False, apply_damage_mask=True
2025-06-02 09:47:57,045 - nutil.core.nutil - INFO - Calling folder_to_atlas_space for coordinate extraction.
2025-06-02 09:48:43,550 - nutil.core.nutil - INFO - Coordinate extraction completed successfully.
2025-06-02 09:48:43,550 - nutil.core.nutil - DEBUG - Number of pixel points: 188655
2025-06-02 09:48:43,550 - nutil.core.nutil - DEBUG - Number of centroids: 21854
2025-06-02 09:48:43,556 - nutil.core.nutil - INFO - Starting coordinate quantification.
2025-06-02 09:48:43,556 - nutil.core.nutil - INFO - Calling quantify_labeled_points for quantification.
2025-06-02 09:48:48,651 - nutil.core.nutil - INFO - Coordinate quantification completed successfully.
2025-06-02 09:48:48,652 - nutil.core.nutil - DEBUG - Label_df shape: (1328, 16)
2025-06-02 09:48:48,652 - nutil.core.nutil - INFO - Attempting to get region summary.
2025-06-02 09:48:48,653 - nutil.core.nutil - INFO - Region summary retrieved successfully.
2025-06-02 09:48:48,856 - nutil.core.nutil - INFO - Attempting to save analysis to: ./test_result/real_worl_use_case
2025-06-02 09:48:48,859 - nutil.core.nutil - INFO - Ensured output folder exists or created: ./test_result/real_worl_use_case
2025-06-02 09:49:30,473 - nutil.core.nutil - INFO - Analysis results saved successfully to: ./test_result/real_worl_use_case
2025-06-02 10:51:18,937 - nutil.core.nutil - INFO - Initializing Nutil class.
2025-06-02 10:51:18,937 - nutil.core.nutil - DEBUG - Parameters: segmentation_folder=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/init_segments, alignment_json=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/aba_mouse_ccfv3_2017_25um_2025-04-11_07-50-43.json, colour=[255, 0, 0], atlas_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas/annotation_25_reoriented_2017.nrrd, label_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas//allen2017_colours.csv, hemi_path=None, custom_region_path=None
2025-06-02 10:51:18,937 - nutil.core.nutil - DEBUG - Validating atlas parameters.
2025-06-02 10:51:18,937 - nutil.core.nutil - DEBUG - Atlas parameters validated successfully.
2025-06-02 10:51:18,937 - nutil.core.nutil - INFO - Loading custom atlas.
2025-06-02 10:51:20,254 - nutil.core.nutil - INFO - Custom atlas loaded successfully.
2025-06-02 10:51:20,254 - nutil.core.nutil - INFO - Starting coordinate extraction.
2025-06-02 10:51:20,254 - nutil.core.nutil - DEBUG - Parameters: non_linear=True, object_cutoff=0, use_flat=False, apply_damage_mask=True
2025-06-02 10:51:20,254 - nutil.core.nutil - INFO - Calling folder_to_atlas_space for coordinate extraction.
2025-06-02 10:51:36,330 - nutil.core.nutil - ERROR - Unexpected error extracting coordinates: loop of ufunc does not support argument 0 of type NoneType which has no callable rint method
AttributeError: 'NoneType' object has no attribute 'rint'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\nutil\core\nutil.py", line 191, in get_coordinates
    ) = folder_to_atlas_space(
        ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\nutil\core\coordinate_extraction.py", line 187, in folder_to_atlas_space
    segmentation_to_atlas_space(
  File "c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\nutil\core\coordinate_extraction.py", line 414, in segmentation_to_atlas_space
    np.round(scaled_y).astype(int), np.round(scaled_x).astype(int)
    ^^^^^^^^^^^^^^^^^^
  File "C:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\.venv\Lib\site-packages\numpy\_core\fromnumeric.py", line 3710, in round
    return _wrapfunc(a, 'round', decimals=decimals, out=out)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\.venv\Lib\site-packages\numpy\_core\fromnumeric.py", line 54, in _wrapfunc
    return _wrapit(obj, method, *args, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\.venv\Lib\site-packages\numpy\_core\fromnumeric.py", line 46, in _wrapit
    result = getattr(arr, method)(*args, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: loop of ufunc does not support argument 0 of type NoneType which has no callable rint method
2025-06-02 10:52:00,530 - nutil.core.nutil - INFO - Initializing Nutil class.
2025-06-02 10:52:00,530 - nutil.core.nutil - DEBUG - Parameters: segmentation_folder=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/init_segments, alignment_json=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/real_data/aba_mouse_ccfv3_2017_25um_2025-04-11_07-50-43.json, colour=[255, 0, 0], atlas_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas/annotation_25_reoriented_2017.nrrd, label_path=c:\Users\ardab\Documents\Projects\Online QUINT\webnutil-service\./tests/test_data/allen_mouse_2017_atlas//allen2017_colours.csv, hemi_path=None, custom_region_path=None
2025-06-02 10:52:00,530 - nutil.core.nutil - DEBUG - Validating atlas parameters.
2025-06-02 10:52:00,530 - nutil.core.nutil - DEBUG - Atlas parameters validated successfully.
2025-06-02 10:52:00,533 - nutil.core.nutil - INFO - Loading custom atlas.
2025-06-02 10:52:01,557 - nutil.core.nutil - INFO - Custom atlas loaded successfully.
2025-06-02 10:52:01,572 - nutil.core.nutil - INFO - Starting coordinate extraction.
2025-06-02 10:52:01,574 - nutil.core.nutil - DEBUG - Parameters: non_linear=True, object_cutoff=0, use_flat=False, apply_damage_mask=True
2025-06-02 10:52:01,574 - nutil.core.nutil - INFO - Calling folder_to_atlas_space for coordinate extraction.
2025-06-02 10:53:26,068 - nutil.core.nutil - INFO - Coordinate extraction completed successfully.
2025-06-02 10:53:26,076 - nutil.core.nutil - DEBUG - Number of pixel points: 188655
2025-06-02 10:53:26,076 - nutil.core.nutil - DEBUG - Number of centroids: 21854
2025-06-02 10:53:26,076 - nutil.core.nutil - INFO - Starting coordinate quantification.
2025-06-02 10:53:26,076 - nutil.core.nutil - INFO - Calling quantify_labeled_points for quantification.
2025-06-02 10:53:26,881 - nutil.core.nutil - INFO - Coordinate quantification completed successfully.
2025-06-02 10:53:26,881 - nutil.core.nutil - DEBUG - Label_df shape: (1328, 16)
2025-06-02 10:53:26,881 - nutil.core.nutil - INFO - Attempting to get region summary.
2025-06-02 10:53:26,881 - nutil.core.nutil - INFO - Region summary retrieved successfully.
2025-06-02 10:53:26,992 - nutil.core.nutil - INFO - Attempting to save analysis to: ./test_result/real_worl_use_case
2025-06-02 10:53:26,992 - nutil.core.nutil - INFO - Ensured output folder exists or created: ./test_result/real_worl_use_case
2025-06-02 10:53:31,281 - nutil.core.nutil - INFO - Analysis results saved successfully to: ./test_result/real_worl_use_case
